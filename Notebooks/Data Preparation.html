<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ac6f722c2e4a4e4998d8cc584ca2ef7b</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="phase-i" class="cell markdown" id="7FziMA8Be3nv">
<h1><strong>Phase I</strong></h1>
</section>
<div class="cell markdown" id="Tr1ybCWcAbHj">
<ol>
<li>Decide dataset</li>
<li>Organize dataset and visualize images</li>
<li>Distribution of output labels</li>
<li>Plan to normalize</li>
</ol>
</div>
<div class="cell markdown" id="nVe3jPP6lFSC">
<p><a href="https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=Wpr8GxjOU8in" class="uri">https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=Wpr8GxjOU8in</a></p>
</div>
<section id="import-images" class="cell markdown" id="1BsIgD56Agzl">
<h1><strong>Import Images</strong></h1>
</section>
<div class="cell markdown" id="7k8QZzhxpwAM">
<p>Images come from google drive.</p>
</div>
<div class="cell code" data-execution_count="1" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="opps7xg48CdQ" data-outputId="5ee266cd-0d8b-471b-c02f-ba2833521675">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/gdrive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/gdrive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zQJTc_Fk93d7" data-outputId="a2ea00a2-1509-4274-d366-d5ad835e5202">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls gdrive<span class="op">/</span>My<span class="op">\</span> Drive<span class="op">/</span>XRAY2</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Files
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="6" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="n-xM_INx-72p" data-outputId="0088f201-90b8-4f14-b255-66b6242fe223">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> cp <span class="op">-</span>r gdrive<span class="op">/</span>My<span class="op">\</span> Drive<span class="op">/</span>XRAY2 .</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls </span></code></pre></div>
<div class="output stream stdout">
<pre><code>^C
gdrive	sample_data  XRAY2
</code></pre>
</div>
</div>
<div class="cell code" id="I4koxgda-0Bd">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> unzip XRAY.Clean</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="hDJjOXYc_hVA" data-outputId="6d472ffd-ea0e-42a8-ea03-7dde65f9a009">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls <span class="op">-</span>l</span></code></pre></div>
<div class="output stream stdout">
<pre><code>total 1466104
drwxr-xr-x 4 root root       4096 Feb  6 03:03 Data
drwx------ 5 root root       4096 Feb  6 02:52 gdrive
drwxr-xr-x 1 root root       4096 Feb  1 14:32 sample_data
-rw------- 1 root root 1501271424 Feb  6 03:03 XRAY.Clean.zip
</code></pre>
</div>
</div>
<section id="image-preprocessing" class="cell markdown" id="lIBln6S5Ans0">
<h1><strong>Image preprocessing</strong></h1>
</section>
<div class="cell code" data-execution_count="93" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="NKO4ILZ2Athe" data-outputId="f0a8a0d2-9c78-4a65-89da-b10e0222309b">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> PIL</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Pillow Version:&#39;</span>, PIL.__version__)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Pillow Version: 7.1.2
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="94" id="lxZMBVmHAwy5">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load and show an image with Pillow</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train/COVID19/COVID19(133).jpg&#39;</span>) </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="95" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="B1-8V8JGCtaN" data-outputId="a2b77ac2-bcbf-4fe7-a8bc-3d4beca8aadc">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Details about the specifc image</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(image.<span class="bu">format</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(image.mode)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(image.size)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>JPEG
RGB
(1884, 1447)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="96" data-colab="{&quot;height&quot;:1000,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="rUGTQrCpCwQO" data-outputId="5717d485-3db9-4ec4-e6ac-0af68dc8473a">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load an image</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> imshow</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.asarray(image).shape)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.asarray(image))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>imshow(np.asarray(image))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(1447, 1884, 3)
[[[  2   2   2]
  [  0   0   0]
  [  5   5   5]
  ...
  [  4   4   4]
  [  3   3   3]
  [  0   0   0]]

 [[  4   4   4]
  [  6   6   6]
  [  6   6   6]
  ...
  [  4   4   4]
  [  3   3   3]
  [  1   1   1]]

 [[  0   0   0]
  [  8   8   8]
  [  9   9   9]
  ...
  [  4   4   4]
  [  3   3   3]
  [  1   1   1]]

 ...

 [[115 115 115]
  [113 113 113]
  [115 115 115]
  ...
  [  6   5   1]
  [  7   5   6]
  [  7   5  10]]

 [[116 116 116]
  [115 115 115]
  [116 116 116]
  ...
  [  5   4   0]
  [  5   4   2]
  [  6   4   9]]

 [[113 113 113]
  [115 115 115]
  [114 114 114]
  ...
  [  5   4   0]
  [  6   5   3]
  [  7   5  10]]]
</code></pre>
</div>
<div class="output execute_result" data-execution_count="96">
<pre><code>&lt;matplotlib.image.AxesImage at 0x7f39ff228ed0&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/3334e26eb4e8d77aa10d1c04825684a2dbc6e949.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="97" data-colab="{&quot;height&quot;:276,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ub6zxt-BDJDO" data-outputId="8b094a9c-5b26-45b3-a1e5-326c9f9eb700">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the color bar with the image</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train/COVID19/COVID19(133).jpg&#39;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.asarray(image))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span></code></pre></div>
<div class="output execute_result" data-execution_count="97">
<pre><code>&lt;matplotlib.colorbar.Colorbar at 0x7f3a00576a50&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/4651ee319faad8fe1626f31f7c09412bed8a7780.png" /></p>
</div>
</div>
<section id="test-image-generator" class="cell markdown" id="SsfbHimlEJQq">
<h1><strong>Test Image Generator</strong></h1>
</section>
<div class="cell code" data-execution_count="98" id="8QmsaDeZEqhK">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="99" id="EBz13gMVEw0q">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale all images - normalized to 255  </span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>my_generator <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="100" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ZbM7osmaFO88" data-outputId="440fb382-4ec6-45c4-98f9-9aa648f96030">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data from training directory and load them into two classes </span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>my_image_generator <span class="op">=</span> my_generator.flow_from_directory( </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train&#39;</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">10</span>, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 4151 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="101" data-colab="{&quot;height&quot;:1000,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="QUN0AxgKGnpf" data-outputId="a2f3a901-5729-44a0-94fb-efa2beccea93">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from my_image_generator and assign labels</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Look through labels and print with colorbar</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> my_batch <span class="kw">in</span> my_image_generator:</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    images <span class="op">=</span> my_batch[<span class="dv">0</span>]</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> my_batch[<span class="dv">1</span>]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(labels)):</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        plt.imshow(images[i])</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        plt.colorbar()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(labels[i])</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/d7fec90983c47ca24ed050486956be09d9f98b8a.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/18396bc89ddcc2ece52e94451e9adfd22ab3ce7f.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/54cb975c50ce14ab01b30b26442b3e8264d95f62.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/070821b3c1fb819b46b0f08faadf521191457ee6.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/839bf098644a27d297dd090e14b78e6cc712555c.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/aec2afa1c020cb4c97520b74841558a1c514a0cd.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/b6011c4e4afad7305cc445f55367d60add1d48e4.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/c66fd1ecc6c563285b226120580a70fc6ef0f100.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/38d163c0be8d5340a4c10118f7280b223f5754cc.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/c5d062ace4b1ece7046733743ddbadf872233d04.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
</div>
<section id="image-augmentation-with-image-generator" class="cell markdown" id="pa1penZdHo4y">
<h1><strong>Image Augmentation (with Image Generator)</strong></h1>
</section>
<div class="cell markdown" id="OPVW8TWsH6-F">
<p>Altering the image data to create more data for the model training process.</p>
</div>
<div class="cell code" data-execution_count="102" id="sgWFAqPIi0RA">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale all images - normalized to 255  </span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>my_generator <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="103" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="nZabsy4rIejX" data-outputId="eb3dbe53-c7ad-4d54-e47f-8e3e2e47f7be">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-load data from training directory and load them into two classes </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>my_image_generator <span class="op">=</span> my_generator.flow_from_directory( </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train&#39;</span>, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">10</span>, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    color_mode<span class="op">=</span><span class="st">&#39;grayscale&#39;</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 4151 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="104" data-colab="{&quot;height&quot;:1000,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="qP16cBqjWWxd" data-outputId="54e72b1c-6680-4a05-d526-a09f035c0823">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the images from the classes in grayscale</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> training_batch <span class="kw">in</span> my_image_generator:</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  images <span class="op">=</span> training_batch[<span class="dv">0</span>]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  labels <span class="op">=</span> training_batch[<span class="dv">1</span>]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(labels)):</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    this_image <span class="op">=</span> np.reshape(images[i], (<span class="dv">150</span>, <span class="dv">150</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    plt.imshow(this_image, <span class="st">&#39;gray&#39;</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(labels[i])</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">break</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/d94ad6544fe316117d0e36dedaa92f61a8264cb8.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/77b72afff2a692577f284c871272dd4596cc14f8.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/40b87c290fca56954f7011c4b42ca865d5ab7036.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/c4750ed75439c31174eac5e457a2d8910fe25d7e.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/542df945a162c995001c5d4857e0a318060a54e1.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/056b65cd90dd04aa861cb57d6d44f594986afe0b.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/ca1bbc445319ae1dd96b332e3e0ba92218fee254.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/9884ad7cdc1910f8214f7544d27ac09a35c2eb88.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/2573aea0b1d5469cb9228e5258c96663ddbaad05.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/b04180f82a7502d01c42052d503219894a73fd24.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="105" id="O-anChgOHtQY">
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding more parameters for image data generator</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>my_augmented_generator <span class="op">=</span> ImageDataGenerator(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    rotation_range<span class="op">=</span><span class="dv">40</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    width_shift_range<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    height_shift_range<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    shear_range<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    zoom_range<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    horizontal_flip<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    rescale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    fill_mode<span class="op">=</span><span class="st">&#39;nearest&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="106" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="tE7aHYCfk6xA" data-outputId="c76f97ba-f575-4097-cd51-d8808669eb2b">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-load data from training directory and load them into two classes </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>training_image_generator <span class="op">=</span> my_augmented_generator.flow_from_directory( </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train&#39;</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    batch_size<span class="op">=</span><span class="dv">10</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    color_mode<span class="op">=</span><span class="st">&#39;grayscale&#39;</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 4151 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="108" data-colab="{&quot;height&quot;:1000,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="SC_1Aq3tIn_Y" data-outputId="7598e83c-985b-4f12-8795-551d1d6f8a0e">
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-loaded images with augmentation applied</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the images from the classes in grayscale</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> training_batch <span class="kw">in</span> training_image_generator:</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  images <span class="op">=</span> training_batch[<span class="dv">0</span>]</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  labels <span class="op">=</span> training_batch[<span class="dv">1</span>]</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(labels)):</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    this_image <span class="op">=</span> np.reshape(images[i], (<span class="dv">150</span>, <span class="dv">150</span>))</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    plt.imshow(this_image, <span class="st">&#39;gray&#39;</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(labels[i])</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">break</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/ea858ff1b0ee2cb80ad041ebb6cf614c45d039a7.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/2adca3fdc9d959f42c5790469c48cf8059cedf1d.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/88ba9acd70179aeb68d1c2fe212b621fae33969a.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/f0c3c2e4f92704bf2f9c3ca1f6fd23a876b8834a.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/114663f0044da7d3b19cd2b865321bb87febeaff.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/d48763a1ad3a49f53e2564708a65deef9eca5983.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/729f92c201d7861af460a5baab7d1c4a4222d108.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/56062506722d55a77e4b39fbe3cf9bb9789385e1.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/f71c826a0bc813b207b6a552ff2bee4346571b0d.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>0.0
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/8992dc504f01c17a51582413f13e7df071f79e9e.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>1.0
</code></pre>
</div>
</div>
<section id="data-visualization" class="cell markdown" id="juJuDQLAJTEF">
<h1><strong>Data Visualization</strong></h1>
</section>
<div class="cell code" data-execution_count="109" id="2PdxG1koJWjx">
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas  <span class="im">as</span> pd</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="110" id="lHo58jSKcxjn">
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pathlib</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="111" id="HSnKIcgMdXzI">
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="112" id="Pc3utkouOLVE">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>TRAIN_DATA_COVID <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train/COVID19&#39;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>TRAIN_DATA_NORMAl <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train/NORMAL&#39;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>TEST_DATA_COVID19 <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/test/COVID19&#39;</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>TEST_DATA_NORMAL <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/test/NORMAL&#39;</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="113" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="WwOEtKgNYGzf" data-outputId="6fe895b9-120c-494c-ca9a-3a4e68077b0c">
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(TRAIN_DATA_COVID)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>/content/gdrive/MyDrive/XRAY2/Files/Data/train/COVID19
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="114" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ssBkwOLPPd4K" data-outputId="3a689742-9a0f-4eee-f8c1-6f238dcda5d0">
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find total number of images files </span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>DATA_LIST <span class="op">=</span> [TRAIN_DATA_COVID, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>             TRAIN_DATA_NORMAl, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>             TEST_DATA_COVID19, </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>             TEST_DATA_NORMAL ]</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> DATA_LIST <span class="kw">in</span> DATA_LIST:</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="bu">list</span> <span class="op">=</span> os.listdir(DATA_LIST) </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  number_of_files <span class="op">=</span> <span class="bu">len</span>(<span class="bu">list</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(number_of_files)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>1845
2306
521
578
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="115" id="uR738Jr6je7m">
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Declare directoires</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>base_dir <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train&#39;</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>train_dir <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train&#39;</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>train_dir_COVID <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train/COVID19&#39;</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>train_dir_NORMAL <span class="op">=</span> <span class="st">&#39;/content/gdrive/MyDrive/XRAY2/Files/Data/train/NORMAL&#39;</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="116" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="FM8wgcajkGX1" data-outputId="a9f29ee2-4fa4-45fd-8636-9b312a0fb067">
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the filenames</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>train_COVID_fnames <span class="op">=</span> os.listdir(train_dir_COVID)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_COVID_fnames[:<span class="dv">10</span>])</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>train_NORMAL_fnames <span class="op">=</span> os.listdir(train_dir_NORMAL)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co">#train_NORMAL_fnames.sort()</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_NORMAL_fnames[:<span class="dv">10</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;person1387_virus_2382.jpeg&#39;, &#39;person1388_bacteria_3529.jpeg&#39;, &#39;person1389_bacteria_3531.jpeg&#39;, &#39;person1389_virus_2387.jpeg&#39;, &#39;person1390_bacteria_3534.jpeg&#39;, &#39;person1390_bacteria_3535.jpeg&#39;, &#39;person1391_bacteria_3536.jpeg&#39;, &#39;person1391_bacteria_3537.jpeg&#39;, &#39;person1392_bacteria_3538.jpeg&#39;, &#39;person1393_virus_2396.jpeg&#39;]
[&#39;IM-0199-0001.jpeg&#39;, &#39;IM-0201-0001.jpeg&#39;, &#39;IM-0203-0001.jpeg&#39;, &#39;IM-0205-0001.jpeg&#39;, &#39;IM-0206-0001.jpeg&#39;, &#39;IM-0207-0001.jpeg&#39;, &#39;IM-0209-0001.jpeg&#39;, &#39;IM-0210-0001.jpeg&#39;, &#39;IM-0211-0001.jpeg&#39;, &#39;IM-0213-0001.jpeg&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="117" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="nL9ibm9FkV13" data-outputId="91529c4f-bb10-404d-9a36-bf965e423d8b">
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Total number of training COVID images:&#39;</span>, <span class="bu">len</span>(os.listdir(train_dir_COVID)))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Total number of training NORMAL images:&#39;</span>, <span class="bu">len</span>(os.listdir(train_dir_NORMAL)))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&#39;Total number of validation COVID images:&#39;, len(os.listdir(validation_cats_dir)))</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&#39;Total number of validation NORMAL images:&#39;, len(os.listdir(validation_dogs_dir)))</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Total number of training COVID images: 1845
Total number of training NORMAL images: 2306
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="118" id="XfHNIGbEkn06">
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make graph to show off images</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>nrows <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>ncols <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>pic_index <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="119" data-colab="{&quot;height&quot;:865,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="cVfWuympkp0O" data-outputId="ee4087bb-32e9-4a82-beaa-a66139ac111e">
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up 4x4 figure to show new batch everytime</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.gcf()</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches(ncols <span class="op">*</span> <span class="dv">4</span>, nrows <span class="op">*</span> <span class="dv">4</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>pic_index <span class="op">+=</span> <span class="dv">8</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>covid_chestxray <span class="op">=</span> [os.path.join(train_dir_COVID, fname) </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> fname <span class="kw">in</span> train_COVID_fnames[pic_index<span class="op">-</span><span class="dv">8</span>:pic_index]]</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>normal_chestxray <span class="op">=</span> [os.path.join(train_dir_NORMAL, fname) </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> fname <span class="kw">in</span> train_NORMAL_fnames[pic_index<span class="op">-</span><span class="dv">8</span>:pic_index]]</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, img_path <span class="kw">in</span> <span class="bu">enumerate</span>(covid_chestxray<span class="op">+</span>normal_chestxray):</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  subp <span class="op">=</span> plt.subplot(nrows, ncols, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  subp.axis(<span class="st">&#39;Off&#39;</span>) <span class="co"># Don&#39;t show axes (or gridlines)</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  img <span class="op">=</span> mpimg.imread(img_path)</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  plt.imshow(img)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_653d4b03f85d467680cf2a49bc3db22e/74dfe88dc0221c3adbfed59600df11afc33c284d.png" /></p>
</div>
</div>
</body>
</html>
