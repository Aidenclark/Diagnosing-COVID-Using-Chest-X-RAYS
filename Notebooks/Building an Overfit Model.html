<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>cfb0ef7e66c149cd91e14274c793c0e2</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="phase-ii" class="cell markdown" id="7FziMA8Be3nv">
<h1><strong>Phase II</strong></h1>
</section>
<div class="cell markdown" id="Tr1ybCWcAbHj">
<ol>
<li>design a convolutional neural network to overfit the dataset</li>
<li>Don't split data, to design smallest possible CNN</li>
<li>Report should talk about accuracy, precision, recall, etc.</li>
</ol>
</div>
<div class="cell markdown" id="nVe3jPP6lFSC">
<p><a href="https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=Wpr8GxjOU8in" class="uri">https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=Wpr8GxjOU8in</a></p>
</div>
<section id="import-images" class="cell markdown" id="1BsIgD56Agzl">
<h1><strong>Import Images</strong></h1>
</section>
<div class="cell markdown" id="b3EfuhAjTfa1">

</div>
<div class="cell markdown" id="7k8QZzhxpwAM">
<p>Images come from google drive.</p>
</div>
<div class="cell code" data-execution_count="1" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="opps7xg48CdQ" data-outputId="b9f8b678-e6ec-40c5-f0eb-4315979d42d2">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/gdrive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/gdrive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zQJTc_Fk93d7" data-outputId="b186eb33-3cda-4a66-f706-7c063ad298c2">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls gdrive<span class="op">/</span>My<span class="op">\</span> Drive<span class="op">/</span>XRAY2</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Files
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="3" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="n-xM_INx-72p" data-outputId="881a0d0e-3d8c-4b52-f2e7-4187d86c04fb">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> cp <span class="op">-</span>r gdrive<span class="op">/</span>My<span class="op">\</span> Drive<span class="op">/</span>XRAY2 .</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls </span></code></pre></div>
<div class="output stream stdout">
<pre><code>gdrive	sample_data  XRAY2
</code></pre>
</div>
</div>
<section id="building-generators" class="cell markdown" id="Fj6NrwiHcarm">
<h1><strong>Building Generators</strong></h1>
</section>
<div class="cell code" data-execution_count="28" id="XAeXrmf-cdBv">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.datasets <span class="im">import</span> mnist</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> <span class="op">*</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> <span class="op">*</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="29" id="54xYjHrXYmsO">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="30" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Ag2H5sP_H6C1" data-outputId="5a32ecd5-b4b8-4b40-f5c1-2a883bdb56fb">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>, force_remount<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/drive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="31" id="9uMPIZnmYuVZ">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale by 1./255</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>my_generator <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="32" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="l5fJoUYMY2qQ" data-outputId="8faa4bce-360a-443b-a2a2-592a1cd400ad">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generator for training dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>train_generator <span class="op">=</span> my_generator.flow_from_directory( <span class="st">&#39;/content/drive/MyDrive/XRAY2/Files/Data/train/&#39;</span>, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), batch_size<span class="op">=</span><span class="dv">4</span>, class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 4151 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="33" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Zfythe01g8-E" data-outputId="2bc801a0-a05f-43f5-e78f-2218d3cef2ef">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generator for training dataset</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>valid_generator <span class="op">=</span> my_generator.flow_from_directory( <span class="st">&#39;/content/drive/MyDrive/XRAY2/Files/Data/test/&#39;</span>, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), batch_size<span class="op">=</span><span class="dv">4</span>, class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 1099 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell markdown" id="_BbdSTRvhOpq">
<p><strong>Check that the generators are working:</strong></p>
</div>
<div class="cell code" data-execution_count="34" data-colab="{&quot;height&quot;:304,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="XaazUjJVhH9V" data-outputId="33d2d712-78bb-4eb4-af47-099d585ce772">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> my_batch <span class="kw">in</span> train_generator:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># my_batch is a tuple with images and labels</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    images <span class="op">=</span> my_batch[<span class="dv">0</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> my_batch[<span class="dv">1</span>]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(labels)):</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Gives one image and its corresponding label</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        plt.imshow(images[i])</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        plt.colorbar()</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(images[i].shape)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(labels[i])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_87741e17542449e2b4f57ed9c31cfe4c/9c07bbf2e7acbe801a9e12cdeb2b7deeb482cb8e.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>(150, 150, 3)
0.0
</code></pre>
</div>
</div>
<section id="building-the-models" class="cell markdown" id="GMRYaDQrmPtl">
<h1><strong>Building the Models</strong></h1>
</section>
<div class="cell code" data-execution_count="35" id="B4EqFZyMmnQz">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> MaxPooling2D, Dense, Conv2D, Flatten</span></code></pre></div>
</div>
<div class="cell markdown" id="P_paELlrhRnW">
<p><strong>Build a baseline model:</strong></p>
</div>
<div class="cell code" data-execution_count="36" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ZyfYJwgkhTqQ" data-outputId="23403e0d-f9a6-4ee3-a0f1-3ca8591dd788">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model_baseline <span class="op">=</span> Sequential()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Conv2D( <span class="dv">16</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>) ) )</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Conv2D( <span class="dv">4</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Flatten() )</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Dense( <span class="dv">10</span>, activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Dense( <span class="dv">1</span>, activation <span class="op">=</span> <span class="st">&#39;sigmoid&#39;</span> ) )</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>model_baseline.summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Model: &quot;sequential_6&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_14 (Conv2D)          (None, 148, 148, 16)      448       
                                                                 
 conv2d_15 (Conv2D)          (None, 146, 146, 4)       580       
                                                                 
 flatten_6 (Flatten)         (None, 85264)             0         
                                                                 
 dense_12 (Dense)            (None, 10)                852650    
                                                                 
 dense_13 (Dense)            (None, 1)                 11        
                                                                 
=================================================================
Total params: 853,689
Trainable params: 853,689
Non-trainable params: 0
_________________________________________________________________
</code></pre>
</div>
</div>
<div class="cell markdown" id="TONHVxWym8dv">
<p><strong>Building the overfit model</strong></p>
</div>
<div class="cell code" data-execution_count="37" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="UOIJ8a5mmgB1" data-outputId="2cd6fe06-fa55-440b-84c3-c3969d974bff">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>model_overfit <span class="op">=</span> Sequential()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>model_overfit.add( Conv2D( <span class="dv">64</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>) ) )</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>model_overfit.add( MaxPooling2D(<span class="dv">4</span>, <span class="dv">4</span>) )</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>model_overfit.add( Conv2D( <span class="dv">32</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>model_overfit.add( MaxPooling2D(<span class="dv">4</span>, <span class="dv">4</span>) )</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>model_overfit.add( Conv2D( <span class="dv">16</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>model_overfit.add( Flatten() )</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>model_overfit.add( Dense( <span class="dv">10</span>, activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>model_overfit.add( Dense( <span class="dv">1</span>, activation <span class="op">=</span> <span class="st">&#39;sigmoid&#39;</span> ) )</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>model_overfit.summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Model: &quot;sequential_7&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_16 (Conv2D)          (None, 148, 148, 64)      1792      
                                                                 
 max_pooling2d_4 (MaxPooling  (None, 37, 37, 64)       0         
 2D)                                                             
                                                                 
 conv2d_17 (Conv2D)          (None, 35, 35, 32)        18464     
                                                                 
 max_pooling2d_5 (MaxPooling  (None, 8, 8, 32)         0         
 2D)                                                             
                                                                 
 conv2d_18 (Conv2D)          (None, 6, 6, 16)          4624      
                                                                 
 flatten_7 (Flatten)         (None, 576)               0         
                                                                 
 dense_14 (Dense)            (None, 10)                5770      
                                                                 
 dense_15 (Dense)            (None, 1)                 11        
                                                                 
=================================================================
Total params: 30,661
Trainable params: 30,661
Non-trainable params: 0
_________________________________________________________________
</code></pre>
</div>
</div>
<section id="compile-the-models" class="cell markdown" id="pDpAdBW9nBvZ">
<h1><strong>Compile the Models</strong></h1>
</section>
<div class="cell code" data-execution_count="38" id="SjBRHpL81d1O">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> metrics</span></code></pre></div>
</div>
<div class="cell markdown" id="709yKKz-hYwA">
<p><strong>Train the model using training generator and evaluate on validation generator</strong></p>
</div>
<div class="cell code" data-execution_count="39" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="d67xO3qnhdtM" data-outputId="45d2605b-a7fc-410d-d586-89b08263fa26">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>model_baseline.<span class="bu">compile</span>( optimizer <span class="op">=</span> <span class="st">&#39;adam&#39;</span>, loss <span class="op">=</span> <span class="st">&#39;binary_crossentropy&#39;</span>, metrics <span class="op">=</span> [ <span class="st">&#39;accuracy&#39;</span>, metrics.Precision(), metrics.Recall()  ] )</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train using the training set and evaluate using the validation set</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>history_baseline <span class="op">=</span> model_baseline.fit( train_generator, validation_data <span class="op">=</span> valid_generator, epochs <span class="op">=</span> <span class="dv">5</span>, batch_size <span class="op">=</span> <span class="dv">256</span> )</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/5
1038/1038 [==============================] - 283s 272ms/step - loss: 0.3268 - accuracy: 0.8622 - precision_5: 0.8619 - recall_5: 0.8955 - val_loss: 0.1442 - val_accuracy: 0.9500 - val_precision_5: 0.9661 - val_recall_5: 0.9377
Epoch 2/5
1038/1038 [==============================] - 297s 286ms/step - loss: 0.1432 - accuracy: 0.9492 - precision_5: 0.9537 - recall_5: 0.9549 - val_loss: 0.1344 - val_accuracy: 0.9481 - val_precision_5: 0.9611 - val_recall_5: 0.9394
Epoch 3/5
1038/1038 [==============================] - 282s 271ms/step - loss: 0.0628 - accuracy: 0.9815 - precision_5: 0.9831 - recall_5: 0.9835 - val_loss: 0.1835 - val_accuracy: 0.9281 - val_precision_5: 0.9561 - val_recall_5: 0.9048
Epoch 4/5
1038/1038 [==============================] - 281s 271ms/step - loss: 0.0793 - accuracy: 0.9749 - precision_5: 0.9804 - recall_5: 0.9744 - val_loss: 0.1540 - val_accuracy: 0.9454 - val_precision_5: 0.9481 - val_recall_5: 0.9481
Epoch 5/5
1038/1038 [==============================] - 281s 271ms/step - loss: 0.0260 - accuracy: 0.9933 - precision_5: 0.9939 - recall_5: 0.9939 - val_loss: 0.2216 - val_accuracy: 0.9308 - val_precision_5: 0.9343 - val_recall_5: 0.9343
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="40" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="cG8r5aEFnmOu" data-outputId="f756fa23-d5dd-4b7a-831f-e453427e8d7c">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model_overfit.<span class="bu">compile</span>( optimizer <span class="op">=</span> <span class="st">&#39;adam&#39;</span>, loss <span class="op">=</span> <span class="st">&#39;binary_crossentropy&#39;</span>, metrics <span class="op">=</span> [ <span class="st">&#39;accuracy&#39;</span>, metrics.Precision(), metrics.Recall()  ] )</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train using the training set and evaluate using the validation set</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>history_overfit <span class="op">=</span> model_overfit.fit( train_generator, validation_data <span class="op">=</span> valid_generator, epochs <span class="op">=</span> <span class="dv">5</span>, batch_size <span class="op">=</span> <span class="dv">256</span> )</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/5
1038/1038 [==============================] - 276s 265ms/step - loss: 0.3233 - accuracy: 0.8689 - precision_6: 0.8605 - recall_6: 0.9120 - val_loss: 0.1561 - val_accuracy: 0.9518 - val_precision_6: 0.9442 - val_recall_6: 0.9654
Epoch 2/5
1038/1038 [==============================] - 275s 265ms/step - loss: 0.1973 - accuracy: 0.9289 - precision_6: 0.9314 - recall_6: 0.9415 - val_loss: 0.1449 - val_accuracy: 0.9354 - val_precision_6: 0.8980 - val_recall_6: 0.9896
Epoch 3/5
1038/1038 [==============================] - 275s 265ms/step - loss: 0.1642 - accuracy: 0.9419 - precision_6: 0.9449 - recall_6: 0.9510 - val_loss: 0.1642 - val_accuracy: 0.9454 - val_precision_6: 0.9375 - val_recall_6: 0.9602
Epoch 4/5
1038/1038 [==============================] - 275s 265ms/step - loss: 0.1411 - accuracy: 0.9494 - precision_6: 0.9529 - recall_6: 0.9562 - val_loss: 0.1225 - val_accuracy: 0.9636 - val_precision_6: 0.9945 - val_recall_6: 0.9360
Epoch 5/5
1038/1038 [==============================] - 273s 263ms/step - loss: 0.1329 - accuracy: 0.9562 - precision_6: 0.9621 - recall_6: 0.9588 - val_loss: 0.0909 - val_accuracy: 0.9745 - val_precision_6: 0.9758 - val_recall_6: 0.9758
</code></pre>
</div>
</div>
<section id="learning-curves" class="cell markdown" id="mzq-x0_EnvQC">
<h1><strong>Learning Curves</strong></h1>
</section>
<div class="cell markdown" id="dUwjvQ2Wkm1U">
<p><strong>Assess the learning curves</strong></p>
</div>
<div class="cell code" data-execution_count="41" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="htwMwBs_klAk" data-outputId="384fb040-b999-4736-91e4-e26492cc564b">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history_baseline.params)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;verbose&#39;: 1, &#39;epochs&#39;: 5, &#39;steps&#39;: 1038}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="42" data-colab="{&quot;height&quot;:295,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="fwNXA-jvkuIP" data-outputId="b33ee1ad-f9ad-4d32-c266-c2f631081cc3">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&#39;val_accuracy&#39;</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Baseline Model&quot;</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Training Data&#39;</span>, <span class="st">&#39;Validation Data&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_87741e17542449e2b4f57ed9c31cfe4c/71178df46642c9c907ee1157cdbb909ada623086.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="3j_B5Gl3wD8l" data-outputId="c3af1f75-c77e-4897-8e68-7091187f44b5">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history_overfit.params)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;verbose&#39;: 1, &#39;epochs&#39;: 5, &#39;steps&#39;: 1038}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="43" data-colab="{&quot;height&quot;:295,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zAjHhMf1wIHx" data-outputId="0a8619a2-e5f2-4110-ca3b-c0234f36dd36">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_overfit.history[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_overfit.history[<span class="st">&#39;val_accuracy&#39;</span>])</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Over-fit Model&quot;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Training Data&#39;</span>, <span class="st">&#39;Validation Data&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_87741e17542449e2b4f57ed9c31cfe4c/68db7258d9974b878f94770044a1cb106e541b18.png" /></p>
</div>
</div>
<section id="evaluate-the-models" class="cell markdown" id="j3DnnwHBov4j">
<h1><strong>Evaluate the Models</strong></h1>
</section>
<div class="cell code" data-execution_count="53" data-colab="{&quot;height&quot;:281,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="_CObGiw4pBNs" data-outputId="c964f44c-38cc-48e4-f7a9-c0ce314f4ad4">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&quot;precision_5&quot;</span>], color<span class="op">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&quot;recall_5&quot;</span>], color<span class="op">=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Parameters = 853,689 (Baseline) &quot;</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Precision Score&#39;</span>, <span class="st">&#39;Recall Score&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_87741e17542449e2b4f57ed9c31cfe4c/17586ffd64f09f1e0155601d2b14c56a6c056568.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="54" data-colab="{&quot;height&quot;:281,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="AUb_P4fzqkgY" data-outputId="ba424045-cb2a-41bf-c040-981b159a3a30">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_overfit.history[<span class="st">&quot;precision_6&quot;</span>], color<span class="op">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_overfit.history[<span class="st">&quot;recall_6&quot;</span>], color<span class="op">=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Parameters = 30,661 (Over-fit) &quot;</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Precision Score&#39;</span>, <span class="st">&#39;Recall Score&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_87741e17542449e2b4f57ed9c31cfe4c/e916c2ca6e78ed8a588aa9434e6efa54a0405e5c.png" /></p>
</div>
</div>
</body>
</html>
