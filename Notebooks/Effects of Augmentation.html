<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>3609683660bb4782a85d6e285b6396f8</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="phase-iv" class="cell markdown" id="7FziMA8Be3nv">
<h1><strong>Phase IV</strong></h1>
</section>
<div class="cell markdown" id="Tr1ybCWcAbHj">
<ol>
<li>Increase your accuracy on the validation set</li>
<li>Apply various data augmentation techniques</li>
<li>Table showing how the various parameters of data augmentation affect the validation setâ€™s accuracy</li>
</ol>
</div>
<div class="cell markdown" id="nVe3jPP6lFSC">
<p><a href="https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=Wpr8GxjOU8in" class="uri">https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=Wpr8GxjOU8in</a></p>
</div>
<div class="cell markdown" id="dud-NFzZYzmY">
<p><strong>Rescale and rotation range:</strong> loss: 0.4541 - accuracy: 0.8084 - precision: 0.8058 - recall: 0.8545 - val_loss: 0.4233 - val_accuracy: 0.8060 - val_precision: 0.8027 - val_recall: 0.9005</p>
</div>
<div class="cell markdown" id="GvSB4vC1c4pV">
<p><strong>width and height shift:</strong> loss: 0.4674 - accuracy: 0.8096 - precision: 0.8325 - recall: 0.8146 - val_loss: 0.4072 - val_accuracy: 0.8376 - val_precision: 0.8621 - val_recall: 0.8706</p>
</div>
<div class="cell markdown" id="n29FLGPkgiAj">
<p><strong>Shear range:</strong> val_loss: 0.2160 - val_accuracy: 0.9519 - val_precision_2: 0.9363 - val_recall_2: 0.9876</p>
</div>
<div class="cell markdown" id="WbxUPidgk2Vx">
<p><strong>Shear range and width and height shift:</strong> val_loss: 0.4460 - val_accuracy: 0.8045 - val_precision: 0.8148 - val_recall: 0.8756</p>
</div>
<section id="import-images" class="cell markdown" id="1BsIgD56Agzl">
<h1><strong>Import Images</strong></h1>
</section>
<div class="cell markdown" id="7k8QZzhxpwAM">
<p>Images come from google drive.</p>
</div>
<div class="cell code" data-execution_count="1" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="opps7xg48CdQ" data-outputId="1a7df4fa-1187-48eb-b452-ea7e47a77a39">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/gdrive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/gdrive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zQJTc_Fk93d7" data-outputId="be1da6e3-22ac-45df-9e1f-e4cc67988dea">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls gdrive<span class="op">/</span>My<span class="op">\</span> Drive<span class="op">/</span>XRAY4</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Files
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="3" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="n-xM_INx-72p" data-outputId="7494b3fa-3a2b-42c0-ff3a-af1bb56b02e5">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> cp <span class="op">-</span>r gdrive<span class="op">/</span>My<span class="op">\</span> Drive<span class="op">/</span>XRAY4 .</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> ls </span></code></pre></div>
<div class="output stream stdout">
<pre><code>drive  gdrive  sample_data  XRAY4
</code></pre>
</div>
</div>
<section id="building-generators-w-image-augmentation" class="cell markdown" id="Fj6NrwiHcarm">
<h1><strong>Building Generators w/ Image Augmentation</strong></h1>
</section>
<div class="cell code" data-execution_count="4" id="XAeXrmf-cdBv">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.datasets <span class="im">import</span> mnist</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> to_categorical</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> <span class="op">*</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> <span class="op">*</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5" id="54xYjHrXYmsO">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="6" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Ag2H5sP_H6C1" data-outputId="51874234-c715-4e7f-d838-cd372d4f6f4e">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>, force_remount<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mounted at /content/drive
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="33" id="9uMPIZnmYuVZ">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale by 1./255</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>my_generator <span class="op">=</span> ImageDataGenerator(rescale<span class="op">=</span><span class="fl">1.</span><span class="op">/</span><span class="dv">255</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="8" id="KVNnYOIRMBpl">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>my_generator <span class="op">=</span> ImageDataGenerator(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>      <span class="co">#rescale=1./255,</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="co">#rotation_range=40,</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>      <span class="co">#width_shift_range=0.2,</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="co">#height_shift_range=0.2,</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="co">#shear_range=0.2,</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>      <span class="co">#zoom_range=0.2,</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      <span class="co">#horizontal_flip=True,</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>      fill_mode<span class="op">=</span><span class="st">&#39;nearest&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="34" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="l5fJoUYMY2qQ" data-outputId="545e9468-911e-4545-b805-7b045cfef2fa">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generator for training dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>train_generator <span class="op">=</span> my_generator.flow_from_directory( <span class="st">&#39;/content/drive/MyDrive/XRAY4/Files/Data/train/&#39;</span>, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), batch_size<span class="op">=</span><span class="dv">4</span>, class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 3492 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="35" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="Zfythe01g8-E" data-outputId="d5283df1-e423-4053-8913-ad34fa2b6d71">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generator for validation dataset</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>valid_generator <span class="op">=</span> my_generator.flow_from_directory( <span class="st">&#39;/content/drive/MyDrive/XRAY4/Files/Data/validation/&#39;</span>, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), batch_size<span class="op">=</span><span class="dv">4</span>, class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 665 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="36" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="U4bUr8rY_6Gx" data-outputId="709c3239-e794-4a78-975e-4547aff47004">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generator for test dataset</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>test_generator <span class="op">=</span> my_generator.flow_from_directory( <span class="st">&#39;/content/drive/MyDrive/XRAY4/Files/Data/test/&#39;</span>, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>), batch_size<span class="op">=</span><span class="dv">4</span>, class_mode<span class="op">=</span><span class="st">&#39;binary&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 1099 images belonging to 2 classes.
</code></pre>
</div>
</div>
<div class="cell markdown" id="_BbdSTRvhOpq">
<p><strong>Check that the generators are working:</strong></p>
</div>
<div class="cell code" data-execution_count="37" data-colab="{&quot;height&quot;:304,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="XaazUjJVhH9V" data-outputId="692556dd-3ffa-4871-e30c-b9336c73655f">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> my_batch <span class="kw">in</span> train_generator:</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># my_batch is a tuple with images and labels</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    images <span class="op">=</span> my_batch[<span class="dv">0</span>]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> my_batch[<span class="dv">1</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(labels)):</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Gives one image and its corresponding label</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        plt.imshow(images[i])</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        plt.colorbar()</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(images[i].shape)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(labels[i])</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_0a484ce1ba0b483780b9db83e674cdf9/9f87b68445ec084a8dad61a8ce3fbe616976a024.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>(150, 150, 3)
0.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="38" data-colab="{&quot;height&quot;:304,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ku18l3jNAbcj" data-outputId="2a8bd90a-09ee-4417-9155-bdf92ad3c104">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> my_batch <span class="kw">in</span> valid_generator:</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># my_batch is a tuple with images and labels</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    images <span class="op">=</span> my_batch[<span class="dv">0</span>]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> my_batch[<span class="dv">1</span>]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(labels)):</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Gives one image and its corresponding label</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        plt.imshow(images[i])</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        plt.colorbar()</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(images[i].shape)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(labels[i])</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_0a484ce1ba0b483780b9db83e674cdf9/09a1241ca972718f78803e3efdfb6857225256b2.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>(150, 150, 3)
1.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="39" data-colab="{&quot;height&quot;:304,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="dDY1OFDXAhMJ" data-outputId="0833f71a-5e1f-473f-dcab-4e6c873d61a5">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> my_batch <span class="kw">in</span> test_generator:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># my_batch is a tuple with images and labels</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    images <span class="op">=</span> my_batch[<span class="dv">0</span>]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> my_batch[<span class="dv">1</span>]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(labels)):</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Gives one image and its corresponding label</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        plt.imshow(images[i])</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        plt.colorbar()</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(images[i].shape)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(labels[i])</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_0a484ce1ba0b483780b9db83e674cdf9/ae5165bf85a68d4680ab26eec3fb41870375ab84.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>(150, 150, 3)
0.0
</code></pre>
</div>
</div>
<section id="building-the-models" class="cell markdown" id="GMRYaDQrmPtl">
<h1><strong>Building the Models</strong></h1>
</section>
<div class="cell code" data-execution_count="40" id="B4EqFZyMmnQz">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> MaxPooling2D, Dense, Conv2D, Flatten</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="41" id="z-YkCFY_A-EY">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.callbacks <span class="im">import</span> EarlyStopping, ModelCheckpoint</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>cp_callback <span class="op">=</span> ModelCheckpoint(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    filepath <span class="op">=</span> <span class="st">&#39;best_model.hdf5&#39;</span>, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">&#39;val_accuracy&#39;</span>, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    save_best_only <span class="op">=</span> <span class="va">True</span>, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    save_weights_only <span class="op">=</span> <span class="va">True</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>es_callback <span class="op">=</span> EarlyStopping(</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    monitor<span class="op">=</span><span class="st">&#39;val_accuracy&#39;</span>, </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">&#39;min&#39;</span>, </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    patience<span class="op">=</span><span class="dv">20</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div class="cell markdown" id="P_paELlrhRnW">
<p><strong>Build a baseline model:</strong></p>
</div>
<div class="cell code" data-execution_count="42" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="ZyfYJwgkhTqQ" data-outputId="ae2a05ea-fdd4-4cc5-aa0f-c2710ced7300">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>model_baseline <span class="op">=</span> Sequential()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Conv2D( <span class="dv">16</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>) ) )</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Conv2D( <span class="dv">4</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Flatten() )</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Dense( <span class="dv">10</span>, activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>model_baseline.add( Dense( <span class="dv">1</span>, activation <span class="op">=</span> <span class="st">&#39;sigmoid&#39;</span> ) )</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>model_baseline.summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Model: &quot;sequential_4&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_9 (Conv2D)           (None, 148, 148, 16)      448       
                                                                 
 conv2d_10 (Conv2D)          (None, 146, 146, 4)       580       
                                                                 
 flatten_4 (Flatten)         (None, 85264)             0         
                                                                 
 dense_8 (Dense)             (None, 10)                852650    
                                                                 
 dense_9 (Dense)             (None, 1)                 11        
                                                                 
=================================================================
Total params: 853,689
Trainable params: 853,689
Non-trainable params: 0
_________________________________________________________________
</code></pre>
</div>
</div>
<div class="cell markdown" id="TONHVxWym8dv">
<p><strong>Building the 1st model</strong></p>
</div>
<div class="cell markdown" id="4tUjyAQEEHEK">
<p>From overfit model from previous phase. Increased dense neuron count from 10 to 20.</p>
</div>
<div class="cell code" data-execution_count="18" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="E-vudCMdBN-p" data-outputId="6908a96a-5c93-4afb-a9ab-f2832f9a8ab0">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>model_1 <span class="op">=</span> Sequential()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>model_1.add( Conv2D( <span class="dv">64</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>) ) )</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>model_1.add( MaxPooling2D(<span class="dv">4</span>, <span class="dv">4</span>) )</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>model_1.add( Conv2D( <span class="dv">32</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>model_1.add( MaxPooling2D(<span class="dv">4</span>, <span class="dv">4</span>) )</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>model_1.add( Conv2D( <span class="dv">16</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>model_1.add(BatchNormalization())</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>model_1.add( Flatten() )</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>model_1.add( Dense( <span class="dv">20</span>, activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>model_1.add( Dense( <span class="dv">1</span>, activation <span class="op">=</span> <span class="st">&#39;sigmoid&#39;</span> ) )</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>model_1.summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Model: &quot;sequential_1&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d_2 (Conv2D)           (None, 148, 148, 64)      1792      
                                                                 
 max_pooling2d (MaxPooling2D  (None, 37, 37, 64)       0         
 )                                                               
                                                                 
 conv2d_3 (Conv2D)           (None, 35, 35, 32)        18464     
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 8, 8, 32)         0         
 2D)                                                             
                                                                 
 conv2d_4 (Conv2D)           (None, 6, 6, 16)          4624      
                                                                 
 batch_normalization (BatchN  (None, 6, 6, 16)         64        
 ormalization)                                                   
                                                                 
 flatten_1 (Flatten)         (None, 576)               0         
                                                                 
 dense_2 (Dense)             (None, 20)                11540     
                                                                 
 dense_3 (Dense)             (None, 1)                 21        
                                                                 
=================================================================
Total params: 36,505
Trainable params: 36,473
Non-trainable params: 32
_________________________________________________________________
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="19" id="I-X5xPZmNdRc">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>model_3 <span class="op">=</span> Sequential()</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>model_3.add( Conv2D( <span class="dv">16</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span>, input_shape <span class="op">=</span> (<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>) ) )</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>model_3.add( MaxPooling2D(<span class="dv">4</span>, <span class="dv">4</span>) )</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>model_3.add( Conv2D( <span class="dv">4</span>, ( <span class="dv">3</span>, <span class="dv">3</span> ), activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>model_3.add( Flatten() )</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>model_3.add( Dense( <span class="dv">10</span>, activation <span class="op">=</span> <span class="st">&#39;relu&#39;</span> ) )</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>model_3.add( Dense( <span class="dv">1</span>, activation <span class="op">=</span> <span class="st">&#39;sigmoid&#39;</span> ) )</span></code></pre></div>
</div>
<section id="compile-the-models" class="cell markdown" id="pDpAdBW9nBvZ">
<h1><strong>Compile the Models</strong></h1>
</section>
<div class="cell code" data-execution_count="20" id="SjBRHpL81d1O">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> metrics</span></code></pre></div>
</div>
<div class="cell markdown" id="709yKKz-hYwA">
<p><strong>Train the model using training generator and evaluate on validation generator</strong></p>
</div>
<div class="cell code" data-execution_count="43" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="d67xO3qnhdtM" data-outputId="6ae42d3c-45a6-4ba8-efa8-a7d20de3e524">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>model_baseline.<span class="bu">compile</span>( optimizer <span class="op">=</span> <span class="st">&#39;adam&#39;</span>, loss <span class="op">=</span> <span class="st">&#39;binary_crossentropy&#39;</span>, metrics <span class="op">=</span> [ <span class="st">&#39;accuracy&#39;</span>, metrics.Precision(), metrics.Recall()  ] )</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Train using the training set and evaluate using the validation set</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>history_baseline <span class="op">=</span> model_baseline.fit( train_generator, validation_data <span class="op">=</span> valid_generator, epochs <span class="op">=</span> <span class="dv">3</span>, batch_size <span class="op">=</span> <span class="dv">256</span> )</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/3
873/873 [==============================] - 250s 285ms/step - loss: 0.3565 - accuracy: 0.8706 - precision_2: 0.8685 - recall_2: 0.8986 - val_loss: 0.2755 - val_accuracy: 0.9053 - val_precision_2: 0.9007 - val_recall_2: 0.9478
Epoch 2/3
873/873 [==============================] - 235s 270ms/step - loss: 0.1872 - accuracy: 0.9404 - precision_2: 0.9454 - recall_2: 0.9454 - val_loss: 0.2052 - val_accuracy: 0.9338 - val_precision_2: 0.9282 - val_recall_2: 0.9652
Epoch 3/3
873/873 [==============================] - 255s 292ms/step - loss: 0.1089 - accuracy: 0.9636 - precision_2: 0.9689 - recall_2: 0.9643 - val_loss: 0.2160 - val_accuracy: 0.9519 - val_precision_2: 0.9363 - val_recall_2: 0.9876
</code></pre>
</div>
</div>
<section id="learning-curves" class="cell markdown" id="mzq-x0_EnvQC">
<h1><strong>Learning Curves</strong></h1>
</section>
<div class="cell markdown" id="dUwjvQ2Wkm1U">
<p><strong>Assess the learning curves</strong></p>
</div>
<div class="cell code" data-execution_count="44" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="htwMwBs_klAk" data-outputId="63c6b13e-58b0-4ebf-84b5-4d8784a7f86b">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history_baseline.params)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;verbose&#39;: 1, &#39;epochs&#39;: 3, &#39;steps&#39;: 873}
</code></pre>
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="HWk1D22mhOZh" data-outputId="73af2c8c-f066-4282-becf-ea81ba726237">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history_1.params)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>{&#39;verbose&#39;: 1, &#39;epochs&#39;: 5, &#39;steps&#39;: 873}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="45" data-colab="{&quot;height&quot;:295,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="fwNXA-jvkuIP" data-outputId="ba591d06-b258-4fda-f0a4-831b2e95d57e">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&#39;val_accuracy&#39;</span>])</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Baseline Model Learning Curves&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Training Data&#39;</span>, <span class="st">&#39;Validation Data&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_0a484ce1ba0b483780b9db83e674cdf9/17e60b738013d236df64e22718ba3638c08dfb47.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:295,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="zAjHhMf1wIHx" data-outputId="d2f28f24-24f8-45e0-fe18-a6987d21cbed">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_1.history[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_1.history[<span class="st">&#39;val_accuracy&#39;</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Model 1 Learning Curves&quot;</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Training Data&#39;</span>, <span class="st">&#39;Validation Data&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_0a484ce1ba0b483780b9db83e674cdf9/70ca5b29ac228ccf437f7e9a3d031eea01324d3c.png" /></p>
</div>
</div>
<section id="evaluate-the-models" class="cell markdown" id="j3DnnwHBov4j">
<h1><strong>Evaluate the Models</strong></h1>
</section>
<div class="cell code" data-execution_count="47" data-colab="{&quot;height&quot;:281,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="_CObGiw4pBNs" data-outputId="f4b8e1a6-73d2-4913-c95d-cf536aeaa0f2">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&quot;precision_2&quot;</span>], color<span class="op">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_baseline.history[<span class="st">&quot;recall_2&quot;</span>], color<span class="op">=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Parameters = 853,689 (Baseline) &quot;</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Precision Score&#39;</span>, <span class="st">&#39;Recall Score&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_0a484ce1ba0b483780b9db83e674cdf9/d8e1379d1d2abf0737a5e61e6915174ed5daa7ec.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:281,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="AUb_P4fzqkgY" data-outputId="458cf1bd-4630-4175-bafc-91939acc98c4">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history_1.history[<span class="st">&quot;precision_1&quot;</span>], color<span class="op">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history_1.history[<span class="st">&quot;recall_1&quot;</span>], color<span class="op">=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f&quot;Parameters = 36,505 (Model 1) &quot;</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;Precision Score&#39;</span>, <span class="st">&#39;Recall Score&#39;</span>], loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_0a484ce1ba0b483780b9db83e674cdf9/db1f327953cb88bb08c878df7c449acbdac87b35.png" /></p>
</div>
</div>
</body>
</html>
